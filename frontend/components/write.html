<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog - New Post</title>
  
  <style>
    body {
  font-family: Arial, sans-serif;
  background-color: #0782f444;
  margin: 0;
  padding: 0;
}

.container {
  width: 80%;
  margin: 20px auto;
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

h1, h2 {
  text-align: center;
  color: #333;
  font-size: 30px;
}

.form-group {
  margin-bottom: 15px;
  font-size: 20px;
}

label {
  display: block;
  margin-bottom: 5px;
  color: #555;
}

input, textarea, button {
  width: 100%;
  padding: 10px;
  margin-top: 5px;
  border: 1px solid black;
  border-radius: 4px;
}

button {
  background-color: #1367e4;
  color: #fff;
  font-size: 20px;
  cursor: pointer;
  border: none;
}

button:hover {
  background-color: #1a2873;
}

#blogPosts .post {
  border-bottom: 1px solid #ddd;
  padding: 10px 0;
}

#blogPosts .post h3 {
  margin: 0;
  color: #007bff;
}

#blogPosts .post p {
  margin: 5px 0 0;
  color: #555;
}

  </style>
</head>
<body>
  <div class="container">
    <h1>Create a New Blog Post</h1>
    <form id="postForm">
      <div class="form-group">
        <label for="title">Post Title:</label>
        <input type="text" id="title" name="title" placeholder="Enter post title" required>
      </div>
      <div class="form-group">
        <label for="image">Image URL:</label>
        <input type="url" id="image" name="image" placeholder="Enter image URL" required>
      </div>      
      <div class="form-group">
        <label for="content">Post Content:</label>
        <textarea id="content" name="content" placeholder="Write your post here..." rows="10" required></textarea>
      </div>
      <button type="submit">Publish</button>
    </form>
    <h2>Blog Posts</h2>
    <div id="blogPosts"></div>
  </div>
  
  <script>
export async function handleFormSubmission(event) {
  event.preventDefault();

  const title = document.getElementById('title').value;
  const content = document.getElementById('content').value;
  const image = document.getElementById('image').value;

  if (title && content && image) {
    try {
      await fetch('/api/posts', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, content, image }),
      });

      // Optionally reload the posts or the page
      location.reload();
    } catch (error) {
      console.error('Error saving post:', error);
    }
  } else {
    alert('Please fill out all fields.');
  }
}

export async function loadPosts() {
  try {
    const response = await fetch('/api/posts');
    const posts = await response.json();

    const postContainer = document.getElementById('blogPosts');
    postContainer.innerHTML = '';
    posts.forEach((post) => {
      const newPost = document.createElement('div');
      newPost.classList.add('post');

      const postTitle = document.createElement('h3');
      postTitle.textContent = post.title;

      const postContent = document.createElement('p');
      postContent.textContent = post.content;

      const postImage = document.createElement('img');
      postImage.src = post.image;
      postImage.alt = post.title;
      postImage.style.maxWidth = '100%';
      postImage.style.marginTop = '10px';

      newPost.appendChild(postTitle);
      newPost.appendChild(postContent);
      newPost.appendChild(postImage);
      postContainer.appendChild(newPost);
    });
  } catch (error) {
    console.error('Error loading posts:', error);
  }
}

document.getElementById('postForm').addEventListener('submit', handleFormSubmission);
loadPosts();

  </script>

</body>
</html>
